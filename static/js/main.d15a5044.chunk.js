(this["webpackJsonpchat-frontend"]=this["webpackJsonpchat-frontend"]||[]).push([[0],{102:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(42),s=a.n(c),o=a(16),l=a.n(o),u=a(43),m=a(3),i=a(2),E=(a(52),function(e){var t=e.onLogin,a=Object(n.useState)("test"),c=Object(m.a)(a,2),s=c[0],o=c[1],l=Object(n.useState)(""),u=Object(m.a)(l,2),i=u[0],E=u[1],p=Object(n.useState)(!1),d=Object(m.a)(p,2),f=d[0],b=d[1];return r.a.createElement("form",{onSubmit:function(e){!function(e){e.preventDefault(),b(!0);var a={roomID:s,userName:i};b(!1),t(a)}(e)},className:"form-size"},r.a.createElement("h1",{className:"text-center"},"\u0412\u043e\u0439\u0442\u0438"),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"chat-rooms"},"Room:"),r.a.createElement("select",{onChange:function(e){return function(e){o(e.target.value)}(e)},className:"custom-select",id:"chat-rooms",value:s,required:!0},r.a.createElement("option",{value:"test"},"test"),r.a.createElement("option",{value:"frontend"},"frontend"))),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"username"},"Name:"),r.a.createElement("input",{id:"username",type:"name",placeholder:"Enter your name",className:"form-control",onChange:function(e){E(e.target.value)},value:i,required:!0})),r.a.createElement("button",{className:"btn btn-primary btn-block",type:"submit",disabled:f},f?r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{className:"spinner-border spinner-border-sm spinner-margin",role:"status","aria-hidden":"true"}),"Loading..."):"Sign in"))}),p=function(e){var t=e.refLink,a=e.onPressEnter,c=Object(n.useState)({value:"",rows:1,minRows:1,maxRows:3}),s=Object(m.a)(c,2),o=s[0],l=s[1];return r.a.createElement("textarea",{ref:t,className:"form-control textarea-autosize","aria-label":"With textarea",rows:o.rows,style:{resize:"none"},placeholder:"Message",onChange:function(e){var t=o.minRows,a=o.maxRows,n=e.target.rows;e.target.rows=t;var r=~~(e.target.scrollHeight/24);r===n&&(e.target.rows=r),r>=a&&(e.target.rows=a,e.target.scrollTop=e.target.scrollHeight),l(Object(i.a)(Object(i.a)({},o),{},{rows:r<a?r:a,value:e.target.value}))},onKeyDown:function(e){return function(e){13===e.keyCode&&(e.preventDefault(),a())}(e)},autoFocus:!0})},d=(a(53),function(e){var t=e.users,a=e.messages,c=e.handleSendMessage,s=Object(n.useRef)(null),o=Object(n.useRef)(null);Object(n.useEffect)((function(){o.current.scrollTop=o.current.scrollHeight}),[a]);var l=function(){""!==s.current.value&&(c(u(s)),m())},u=function(){return s.current.value},m=function(){s.current.value=""};return r.a.createElement("div",{className:"chat"},r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"chat__content"},r.a.createElement("div",{className:"chat__left-side"},r.a.createElement("h4",{className:"chat__online"},"Users (",t.length,"):"),r.a.createElement("ul",{className:"chat__users"},t.map((function(e,t){return r.a.createElement("li",{className:"chat__user",key:"".concat(e,"_").concat(t)},e)})))),r.a.createElement("div",{className:"chat__right-side"},r.a.createElement("ul",{className:"chat__messages",ref:o},a.map((function(e,t){var a=e.text,n=e.author;return r.a.createElement("li",{className:"chat__message",key:"".concat(n,"_").concat(t)},r.a.createElement("div",{className:"chat__bubble"},r.a.createElement("p",{className:"chat__text"},a)),r.a.createElement("div",{className:"chat__author"},n))}))),r.a.createElement("div",{className:"input-group chat__input-text"},r.a.createElement(p,{refLink:s,onPressEnter:l}),r.a.createElement("div",{className:"input-group-append"},r.a.createElement("button",{onClick:l,className:"btn btn-primary",type:"button"},"Send")))))))}),f=a(44),b="https://chat-backend-socket-vers.herokuapp.com",h=a.n(f).a.connect(b),g=a(45),v=a.n(g),O=function(e,t){switch(t.type){case"JOINED":return Object(i.a)(Object(i.a)({},e),{},{roomID:t.payload.roomID,userName:t.payload.userName,joined:!0});case"SET_USERS":return Object(i.a)(Object(i.a)({},e),{},{users:t.payload});case"SET_MESSAGES":return Object(i.a)(Object(i.a)({},e),{},{messages:t.payload});case"SET_DATA":return Object(i.a)(Object(i.a)({},e),{},{users:t.payload.users,messages:t.payload.messages});default:return e}},N=function(){var e=Object(n.useReducer)(O,{joined:!1,roomID:null,userName:null,users:[],messages:[]}),t=Object(m.a)(e,2),a=t[0],c=t[1],s=function(){var e=Object(u.a)(l.a.mark((function e(t){var a,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c({type:"JOINED",payload:t}),h.emit("ROOM:JOIN",t),e.next=4,v.a.get("".concat(b,"/rooms/").concat(t.roomID));case 4:a=e.sent,n=a.data,c({type:"SET_DATA",payload:n});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),o=function(e){c({type:"SET_USERS",payload:e})},i=function(e){c({type:"SET_MESSAGES",payload:e})};return Object(n.useEffect)((function(){h.on("ROOM:SET_USERS",o),h.on("ROOM:SET_MESSAGES",i)}),[c]),r.a.createElement("div",{className:"wrapper"},a.joined?r.a.createElement(d,Object.assign({},a,{handleSendMessage:function(e){var t={roomID:a.roomID,text:e,author:a.userName};h.emit("ROOM:SET_MESSAGE",t)}})):r.a.createElement(E,{onLogin:s}))};s.a.render(r.a.createElement(N,null),document.getElementById("root"))},46:function(e,t,a){e.exports=a(102)},52:function(e,t,a){},53:function(e,t,a){},83:function(e,t){}},[[46,1,2]]]);
//# sourceMappingURL=main.d15a5044.chunk.js.map